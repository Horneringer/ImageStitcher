# Общая информация

Модуль для сшивки растровых снимков формата GeoTiff.

## Функционал модуля

Функция модуля:
* прочитать изображение. Ожидается tif, tiff, GeoTiff.
* определить наилучшее качество среди всех снимков
* изменить проекцию с исходой на EPSG:3857, если она отличается
* создать зону 5 на 5 км вокруг центра ГО
* сшить снимки с лучшим качеством(не менее 0.8 метров на пиксель)
* сохранить в указанную директорию
* создать запись в СУБД

Модуль ожидает не менее 6 аргументов в виде `/cgi/imageStitcher?${lat}&${lon}&${writeSUBD}&${groupObjId}&${groupObjType}&${savePath}&${tiffPath1}&${tiffPath2}`:
* lat - широта центра объекта
* lon - долгота центра объекта
* writeSUBD - флаг, отвечающий за запись в БД
* groupObjId - id объекта
* groupObjType - тип объекта
* savePath - путь, по которому сохраняется сшитый снимок(создаётся, если не существует)
* tiffPath1, tiffPath2 - пути до исходных снимков(максимум 20)

Все запросы должны начинаться с `${protocol}://${serverpath}:${port}/cgi`

Основные запросы для задачи:
| № | Запрос | Код ответа | Ответ |
|-|-|-|-|
| 1 | /imageStitcher?-70.1937257&11.7394629&1&36&4&/data/outWarpedImage.tif&/opt/5_1_4326.tif&/opt/5_2_4326.tif | 200 OK | Запрос успешно выполнен |
| 2 | /imageStitcher | 400 Bad Request | Клиент отправил неправильное количество аргументов |
| 3 | /imageStitcher?var1=22 | 400 Bad Request | Клиент отправил неправильное количество аргументов |
| 4 | /imageStitcher?var1=11&var2=2&var3=3 | 400 Bad Request | Клиент отправил неправильное количество аргументов |
| 5 | /imageStitcher?/data/pixmap/logo&/usr/share/pixmaps/debian-logo.png | 403 Forbidden | Клиент не имеет прав доступа к контенту |
| 6 | /imageStitcher?-70.1937257&11.7394629&1&36&4&/data/outWarpedImage.tif&/opt/5_3_4326.tif&/opt/5_4_4326.tif | 404 Not Found | Сервер не может найти запрошенный ресурс |
| 7 | /imageStitcher?-70.1937257&11.7394629&1&36&4&/data/outWarpedImage.tif&/opt/5_1_4326.png&/opt/5_2_4326.bmp | 415 Unsupported Media Type | Формат запрашиваемых данных не поддерживается сервером |
| 8 | /imageStitcher?test&tryCatch | 500 Internal Server Error | На сервере произошла ошибка, в результате которой он не может успешно обработать запрос |

> Ошибка с кодом 500 иногда вызывается run time error. Этот случай должен быть обработан с помощью отлова исключений в функции main. Это и не решит всех проблем, но сделает сервис более отказоустойчивым.
